!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);var o=function(e){var t="",n=Math.floor(e),o=Math.floor(e/3600);o>0&&(n-=3600*o,t+="".concat(o,":"));var r,u=Math.floor(e/60);return u>0&&(n-=60*u),t+="".concat(u,":").concat((r=n)>9?"".concat(r):"0".concat(r))},r=function(){return!!(document.fullScreen||document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement||document.fullscreenElement)},u=function(){r()?document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():document.documentElement.requestFullscreen?document.documentElement.requestFullscreen():document.documentElement.msRequestFullscreen?document.documentElement.msRequestFullscreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullscreen&&document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)},a=function(){return void 0!==document.createElement("progress").max};function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),e}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e){var t="function"==typeof Map?new Map:void 0;return(d=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,o)}function o(){return m(e,arguments,f(this).constructor)}return o.prototype=Object.create(e.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),p(o,e)})(e)}function m(e,t,n){return(m=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,n){var o=[null];o.push.apply(o,t);var r=new(Function.bind.apply(e,o));return n&&p(r,n.prototype),r}).apply(null,arguments)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=function(e){function t(){var e,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,r=f(t).call(this),e=!r||"object"!==i(r)&&"function"!=typeof r?s(n):r,Object.defineProperties(s(s(e)),{state:{value:e.setup(),writable:!0},setState:{value:function(t){for(var n in t)t.hasOwnProperty(n)&&(e.state[n]=t[n]);e.render()}},onProgressClick:{value:function(t){var n=e.state.videoTemplate,o=t.target,r=(t.pageX-(o.offsetLeft+o.offsetParent.offsetLeft))/o.offsetWidth;n.currentTime=r*n.duration}},onPlayClick:{value:function(){e.togglePlay()}},onVolumeClick:{value:function(){e.toggleMute()}},onVolumeHover:{value:function(){e.state.controls.volume.volumeSlider.setAttribute("data-state","open")}},onVolumeLeave:{value:function(){e.state.controls.volume.volumeSlider.setAttribute("data-state","close")}},onVolumeChange:{value:function(t){e.changeVolume(t.target.value)}},onFullscreenClick:{value:function(){u(),e.changeButtonState("fullscreen")}},onVideoClick:{value:function(){e.togglePlay()}},onLoadedMetadata:{value:function(){var t=e.state.controls,n=e.state.videoTemplate;t.progress.progressElement.setAttribute("max",n.duration),t.volume.volumeSlider.setAttribute("value",100*n.volume),e.changeButtonState("mute"),e.changeButtonState("play")}},onTimeUpdate:{value:function(){var t=e.state,n=t.model[t.current],r=t.videoTemplate,u=e.state.controls;if(u.time.innerHTML="".concat(o(r.currentTime),"  /  ").concat(o(r.duration)),u.progress.progressElement.value=r.currentTime,u.progress.progressValue.style.width=Math.floor(r.currentTime/r.duration*100)+"%",n.options){var a=n.options.timeout,i=a||10;r.duration-r.currentTime<=i&&(t.videoAttrs.controls&&t.controls.controlsTemplate.setAttribute("data-state","hidden"),t.choicesTemplate.removeAttribute("data-state"))}}},onVideoEnded:{value:function(){var t=e.state;t.next&&(e.setAttribute("current",t.next),t.videoAttrs.controls&&t.controls.controlsTemplate.removeAttribute("data-state"),t.choicesTemplate.setAttribute("data-state","hidden"))}},onChoiceSelected:{value:function(t){e.setAttribute("next",t),e.state.next=t}},onMouseMoveIvid:{value:function(){var t=e.state.choicesTemplate,n=e.state.controls.controlsTemplate;clearTimeout(e.state.timer),e.state.timer=setTimeout(function(){n.setAttribute("data-state","hidden")},2300),t.getAttribute("data-state")&&n.removeAttribute("data-state")}},onKeydown:{value:function(t){var n=e.state.videoTemplate;switch(t.keyCode){case 70:u();break;case 77:e.toggleMute();break;case 39:e.forwardVideo();break;case 37:e.backwardVideo();break;case 38:e.changeVolume(100*n.volume+10);break;case 40:e.changeVolume(100*n.volume-10);break;case 32:e.togglePlay()}}}}),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(t,d(HTMLElement)),c(t,null,[{key:"observedAttributes",get:function(){return["model","current"]}}]),c(t,[{key:"connectedCallback",value:function(){var e,t,n,o,r,u,a,i,l=this,c=this.state;this.render(),e=c.controls,t=this.onProgressClick,n=this.onPlayClick,o=this.onVolumeClick,r=this.onVolumeHover,u=this.onVolumeLeave,a=this.onVolumeChange,i=this.onFullscreenClick,e.progress.progressWrapper.onclick=function(e){return t(e)},e.playButton.onclick=function(){return n()},e.volume.volumeWrapper.onmouseover=function(){return r()},e.volume.volumeWrapper.onmouseleave=function(){return u()},e.volume.volumeButton.onclick=function(){return o()},e.volume.volumeSlider.oninput=function(e){return a(e)},e.volume.volumeSlider.onchange=function(e){return a(e)},e.fullscreenButton.onclick=function(){return i()},document.onkeydown=function(e){return l.onKeydown(e)},c.baseTemplate.onmousemove=function(){return l.onMouseMoveIvid()},c.baseTemplate.onmouseleave=function(e){c.controls.controlsTemplate.setAttribute("data-state","hidden")}}},{key:"attributeChangedCallback",value:function(e,t,n){var o,r,u;null!==t&&this.setState((o={},r=e,u="model"===e?JSON.parse(n):n,r in o?Object.defineProperty(o,r,{value:u,enumerable:!0,configurable:!0,writable:!0}):o[r]=u,o))}},{key:"setup",value:function(){var e={autoplay:this.hasAttribute("autoplay")||null,controls:this.hasAttribute("controls")||null,muted:this.hasAttribute("muted")||null,playsinline:this.hasAttribute("playsinline")||null,poster:this.getAttribute("poster"),preload:this.getAttribute("preload")},t=JSON.parse(this.getAttribute("model")),n=this.getAttribute("next")||"",o=this.getAttribute("current");o||(o=Object.keys(t)[0],this.setAttribute("current",t));var r,u,i,l=((r=document.createElement("div")).setAttribute("class","ivid ivid__wrapper"),r),c=((u=this.firstElementChild)||(u=document.createElement("video")),u.classList.add("ivid__video"),u),s=((i=document.createElement("div")).setAttribute("class","ivid__choice-wrapper"),i.setAttribute("data-state","hidden"),i),d=function(){var e=document.createElement("div");e.setAttribute("class","ivid__ctrls-wrapper");var t=document.createElement("div");t.setAttribute("class","ivid__ctrls-progress");var n=document.createElement("progress");a()||n.setAttribute("data-state","pollyfill");var o=document.createElement("span");a()||o.setAttribute("data-state","pollyfill");var r={progressWrapper:t,progressElement:n,progressValue:o},u=document.createElement("div");u.setAttribute("class","ivid__ctrls-buttons-wrapper");var i=document.createElement("button");i.setAttribute("data-state","pause"),i.setAttribute("class","ivid__ctrls-button material-icons");var l=document.createElement("div");l.setAttribute("class","ivid__ctrls-volume-wrapper");var c=document.createElement("button");c.setAttribute("data-state","volume_up"),c.setAttribute("class","ivid__ctrls-button material-icons");var s=document.createElement("input");s.setAttribute("data-state","close"),s.setAttribute("class","ivid__ctrls-volume"),s.type="range",s.min=0,s.max=100,s.step=1;var d={volumeWrapper:l,volumeButton:c,volumeSlider:s},m=document.createElement("span");m.setAttribute("class","ivid_ctrls-time"),m.innerHTML="0:00  /  0:00";var p=document.createElement("div");p.setAttribute("class","ivid__ctrls-spacer");var f=document.createElement("button");return f.setAttribute("data-state","fullscreen"),f.setAttribute("class","ivid__ctrls-button material-icons"),t.appendChild(n),t.appendChild(o),l.appendChild(c),l.appendChild(s),u.appendChild(i),u.appendChild(l),u.appendChild(m),u.appendChild(p),u.appendChild(f),e.appendChild(t),e.appendChild(u),{controlsTemplate:e,progress:r,playButton:i,volume:d,time:m,fullscreenButton:f}}();return this.innerHTML="",l.appendChild(c),l.appendChild(s),l.appendChild(d.controlsTemplate),this.appendChild(l),{videoAttrs:e,model:t,next:n,current:o,baseTemplate:l,videoTemplate:c,choicesTemplate:s,controls:d,timer:setTimeout(null,300)}}},{key:"render",value:function(){var e,t,n,o,r=this.state,u=r.model[r.current];if(u.options){var a=u.options.fallback||Object.keys(u.options.choices)[0];this.onChoiceSelected(a),u.options.choices&&(e=r.choicesTemplate,t=u,n=this.onChoiceSelected,o=t.options.choices,e.setAttribute("data-state","hidden"),e.innerHTML="",Object.keys(o).map(function(t){var r=document.createElement("button");r.setAttribute("class","ivid__choice-button"),r.innerHTML=o[t],r.onclick=function(){return n(t)},e.appendChild(r)}))}else this.onChoiceSelected(null);!function(e,t,n,o,r,u,a){e.id=n.uid,e.src=n.src,t.autoplay&&(e.autoplay=!0),t.muted&&(e.muted=!0),t.playsinline&&(e.playsinline=!0),t.poster&&(e.poster=t.poster),t.preload&&(e.preload=t.preload),e.onclick=function(e){return o(e)},e.onloadedmetadata=function(){return r()},a&&(e.ontimeupdate=function(){return a()}),u&&(e.onended=function(){return u()})}(r.videoTemplate,r.videoAttrs,u,this.onVideoClick,this.onLoadedMetadata,u.options?this.onVideoEnded:null,u.options?this.onTimeUpdate:null)}},{key:"forwardVideo",value:function(){var e=this.state.videoTemplate;e.currentTime++>e.duration?e.currentTime=e.duration:e.currentTime++}},{key:"backwardVideo",value:function(){var e=this.state.videoTemplate;e.currentTime--<0?e.currentTime=0:e.currentTime--}},{key:"togglePlay",value:function(){var e=this.state.videoTemplate;e.paused?e.play():e.pause(),this.changeButtonState("play")}},{key:"toggleMute",value:function(){var e=this.state.videoTemplate;e.muted=!e.muted,this.changeButtonState("mute")}},{key:"changeVolume",value:function(e){var t=this.state.videoTemplate;t.volume=e>100?1:e<0?0:e/100,t.muted=e<=0,this.changeButtonState("mute")}},{key:"changeButtonState",value:function(e){var t=this.state.baseTemplate,n=this.state.videoTemplate,o=this.state.controls;switch(e){case"play":o.playButton.setAttribute("data-state",n.paused||n.ended?"play_arrow":"pause");break;case"mute":o.volume.volumeSlider.setAttribute("value",100*n.volume),o.volume.volumeButton.setAttribute("data-state",n.muted?"volume_off":n.volume>=.5?"volume_up":"volume_down");break;case"fullscreen":t.setAttribute("data-state",r()?"fullscreen":""),o.fullscreenButton.setAttribute("data-state",r()?"fullscreen":"fullscreen_exit")}}}]),t}();customElements.define("i-video",v)}]);