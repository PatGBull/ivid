!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);var o=function(e){70===e.keyCode&&(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():document.documentElement.requestFullscreen?document.documentElement.requestFullscreen():document.documentElement.msRequestFullscreen?document.documentElement.msRequestFullscreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullscreen&&document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT))};function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function u(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){var t="function"==typeof Map?new Map:void 0;return(l=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,o)}function o(){return s(e,arguments,d(this).constructor)}return o.prototype=Object.create(e.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),a(o,e)})(e)}function s(e,t,n){return(s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,n){var o=[null];o.push.apply(o,t);var r=new(Function.bind.apply(e,o));return n&&a(r,n.prototype),r}).apply(null,arguments)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,o=d(t).call(this);var i=(e=!o||"object"!==r(o)&&"function"!=typeof o?c(n):o).setup();return Object.defineProperties(c(c(e)),{state:{value:i,writable:!0},setState:{value:function(t){for(var n in t)t.hasOwnProperty(n)&&(e.state[n]=t[n]);e.render()}},onVideoEnded:{value:function(){e.state.next&&(e.setAttribute("current",e.state.next),e.state.videoTemplate.setAttribute("controls",!0),e.state.choicesTemplate.classList.add("hidden"))}},onVideoClick:{value:function(){var t=e.state.videoTemplate;t.focus(),t.paused?t.play():t.pause()}},onChoiceSelected:{value:function(t){e.setAttribute("next",t),e.state.next=t}},onTimeUpdate:{value:function(){var t=e.state,n=t.srcmap[t.current].options.timeout,o=n||10,r=t.videoTemplate;r.duration-r.currentTime<=o&&(r.ontimeupdate=null,r.removeAttribute("controls"),t.choicesTemplate.classList.remove("hidden"))}}}),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(t,l(HTMLElement)),u(t,null,[{key:"observedAttributes",get:function(){return["srcmap","current"]}}]),u(t,[{key:"connectedCallback",value:function(){this.render()}},{key:"attributeChangedCallback",value:function(e,t,n){var o,r,i;null!==t&&this.setState((o={},r=e.replace(/(\-\w)/g,function(e){return e[1].toUpperCase()}),i="srcmap"!==e?n:JSON.parse(n),r in o?Object.defineProperty(o,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):o[r]=i,o))}},{key:"setup",value:function(){var e=JSON.parse(this.getAttribute("srcmap")),t=this.getAttribute("current");t||(t=Object.keys(e)[0],this.setAttribute("current",t));var n,r,i,u=this.getAttribute("next")||"",c=function(){var e=document.createElement("style");return e.textContent="\n    .ivid {\n      background-color: black;\n      position: absolute;\n      top: 0;\n      bottom: 0;\n      left: 0;\n      right: 0;\n      width: 100%;\n      height: 100%;\n    }\n\n    .ivid__video {\n      position: absolute;\n      top: 0;\n      bottom: 0;\n      left: 0;\n      right: 0;\n      margin: auto;\n      width: 100%;\n      height: 100%;\n    }\n    \n    .ivid__choice-wrapper {\n      position: absolute;\n      bottom: 0;\n      width: 100%;\n      display: flex;\n      align-items: stretch;\n      align-content: stretch;\n      z-index: 2147483647;\n    }\n\n    .ivid__choice-button {\n      width: 100%;\n      height: 76px;\n      color: white;\n      font-size: large;\n      font-weight: bold;\n      border: none;\n      background-color: rgba(0,0,0,0.28);\n    }\n\n    .ivid__choice-button:hover {\n      font-size: larger;\n      background-color: rgba(0,0,0,0.32);\n    }\n\n    .hidden {\n      display: none;\n    }\n  ",e}(),l=((n=document.createElement("div")).setAttribute("class","ivid ivid__wrapper"),n.onkeydown=function(e){return o(e)},n),s=((r=document.createElement("div")).setAttribute("class","ivid__choice-wrapper hidden"),r),a=((i=this.firstElementChild)||(i=document.createElement("video")),i.classList.add("ivid__video"),i);return this.innerHTML="",this.appendChild(c),l.appendChild(a),l.appendChild(s),this.appendChild(l),{srcmap:e,current:t,next:u,style:c,baseTemplate:l,videoTemplate:a,choicesTemplate:s}}},{key:"render",value:function(){var e,t,n,o,r=this.state,i=r.srcmap[r.current];if(i.options){var u=i.options.fallback||Object.keys(i.options.choices)[0];this.onChoiceSelected(u),i.options.choices&&(e=r.choicesTemplate,t=i,n=this.onChoiceSelected,o=t.options.choices,e.classList.add("hidden"),e.innerHTML="",Object.keys(o).map(function(t){var r=document.createElement("button");r.setAttribute("class","ivid__choice-button"),r.innerHTML=o[t],r.onclick=function(){return n(t)},e.appendChild(r)}))}else this.onChoiceSelected(null);!function(e,t,n,o,r){e.id=t.uid,e.setAttribute("src",t.src),e.setAttribute("preload","auto"),e.setAttribute("controls",!0),e.setAttribute("autoplay",!0),e.setAttribute("playsinline",!0),e.onclick=function(){return n()},r&&(e.ontimeupdate=function(){return r()}),o&&(e.onended=function(){return o()})}(r.videoTemplate,i,this.onVideoClick,i.options?this.onVideoEnded:null,i.options?this.onTimeUpdate:null)}}]),t}();customElements.define("i-video",p)}]);